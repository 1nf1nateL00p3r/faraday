def test_standard_host_vuln_hostnames(vulnerability_factory,
                                      host_with_hostnames,
                                      session):
    vuln = vulnerability_factory.create(host=host_with_hostnames,
                                        service=None)
    session.commit()
    assert set(vuln.hostnames) == set(host_with_hostnames.hostnames)

def test_standard_vuln_service_hostnames(vulnerability_factory,
                                         service_factory,
                                         host_with_hostnames,
                                         session):
    service = service_factory.create(host=host_with_hostnames)
    vuln = vulnerability_factory.create(service=service, host=None)
    session.commit()
    assert set(vuln.hostnames) == set(host_with_hostnames.hostnames)

def test_web_vuln_hostnames(vulnerability_web_factory,
                            service_factory,
                            host_with_hostnames,
                            session):
    service = service_factory.create(host=host_with_hostnames)
    vuln = vulnerability_web_factory.create(service=service)
    session.commit()
    assert set(vuln.hostnames) == set(host_with_hostnames.hostnames)

def test_code_vuln(vulnerability_code, session):
    session.commit()
    # Source code vulnerabilities have no hostnames
    assert vulnerability_code.hostnames == []
